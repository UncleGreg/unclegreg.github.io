{"version":3,"sources":["app/js/initialize.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA5KA;AAAA","file":"public/js/app.js","sourcesContent":["document.addEventListener('DOMContentLoaded', () => {\nvar $ = require('jquery');\n\nconst fileName = \"varnish.log\"\n\n// display when js is off\n$('.js-error').css('display', 'none')\n  \n// light tabs\n  $('ul.tabs li').click(function(){\n    var tab_id = $(this).attr('data-tab');\n\n    $('ul.tabs li').removeClass('current');\n    $('.tab-content').removeClass('current');\n\n    $(this).addClass('current');\n    $(\"#\"+tab_id).addClass('current');\n  })\n\n// RSS feed\n\t\n\tvar rssurl = \"https://www.vg.no/rss/feed/forsiden/?frontId=1\";\n  $('#js-rss-url').append(\"URL: \" + rssurl);\n\n\tvar rssFeed = new Array();\n\n\t$.get(rssurl, function(data) {\n\t\tvar $xml = $(data);\n\t\t$xml.find(\"item\").each(function() {\n\t\t\tvar $this = $(this),\n\t\t\t\titem = {\n\t\t\t\t\ttitle: $this.find(\"title\").text(),\n\t\t\t\t\tlink: $this.find(\"link\").text(),\n\t\t\t\t\tpubDate: $this.find(\"pubDate\").text(),\n\t\t\t\t\timgRegular: $this.find(\"imgRegular\").text(),\n\t\t\t\t\timage: $this.find(\"image\").text(),\n\t\t\t\t}\n\n\t\t\tvar date = item.pubDate;\n\t\t\tvar dateParts = date.split('+');\n\t\t\tvar pubDate = dateParts[0].slice(0,-9);\n\n\t\t\titem.pubDate = pubDate;\n\n\t\t\trssFeed.push(item);\n\t\t});\n\n\n    rssFeed.sort(function(a,b){\n      return new Date(b.pubDate) - new Date(a.pubDate);\n    });\n    \n      for(var i = 0 ; i < rssFeed.length ; i++){\n        $( \"#js-rss-feeds\" ).append(\"<li class='feed-list__item'><a href='\" + rssFeed[i].link + \"' target='_blank' style='background-image: url(\" + rssFeed[i].image + \")'><div class='feed-list__title'><span>Title:</span>\" + \"<p>\" + rssFeed[i].title + \"</p></div>\"  + \"<div class='feed-list__date'>\" + rssFeed[i].pubDate + \"</div></a></li>\");\n      };\n\n\n    $('#js-grid-view').click(function() {\n      $('#js-rss-feeds').toggleClass('grid-view'); \n      $('#js-grid-view').toggleClass('animate');\n    });\n    \n\t});\n\n\n});\n$.get('varnish.log', function(data) {\n  var lines = data.trim().split(\"\\n\")\n  .map(function(line){\n    return line.split(/[\"]/gi)\n    .map(function(element){\n        return element.trim().replace(/[\"\\[\\]]/gi,'');\n        });\n  });\n  \n\n\n\tvar hosts = new Array();\n\tvar files = new Array();\n\n\tfor(var i = 0 ; i < lines.length ; i++){\n\n    var host = lines[i][3];\n    var file = lines[i][1];\n\n    var hostParts = host.split('/');\n    var fileParts = file.split(' ');\n\n    var hostname = hostParts[2];\n    var file = fileParts[1];\n\n    hosts.push(hostname);\n    files.push(file);\n\n\t}\n\n  var obj = { };\n\n\t//var arr3 = []\n\t\n  for (var i = 0, j = hosts.length; i < j; i++) {\n    if (obj[hosts[i]]) {\n      obj[hosts[i]]++;\n    }\n    else {\n      obj[hosts[i]] = 1;\n    } \n  }\n\n let arr = $.map(obj, function(value, index) {\n    return [[index, value]];\n});\n\n  arr.sort(function(a,b){\n    return a[1] < b[1] ? 1 : -1;\n  });\n\n  $('#js-hostname-count').append(arr.length)\n\n\n  var obj2 = { };\n\n  for (var i = 0, j = files.length; i < j; i++) {\n    if (obj2[files[i]]) {\n      obj2[files[i]]++;\n    }\n    else {\n      obj2[files[i]] = 1;\n    } \n  }\n\n let arr2 = $.map(obj2, function(value, index) {\n    return [[index, value]];\n});\n\n  arr2.sort(function(a,b){\n    return a[1] < b[1] ? 1 : -1;\n  });\n\n  $('#js-files-count').append(arr2.length)\n\n  \n\n  for(var i = 0 ; i < 5 ; i++){\n\n    var percent = (arr[i][1]/lines.length * 100).toFixed(1);\n    var percent2 = (arr2[i][1]/lines.length * 100).toFixed(1);\n    var barWidth = \"calc(100%/100 *\"+ percent+ \")\";\n\n    $('#js-log-hostnames').append(\"<li><div class='hostnames-list__data'><div class='hostnames-list__host'><img src='http://www.google.com/s2/favicons?domain_url=http%3A%2F%2F\" + arr[i][0] + \"%2F' alt='favicon'>\" + \"  \" + arr[i][0] +\"</div><div class='hostnames-list__numbers'><div class='hostnames-list__percent'>\" + percent  + \"%</div><div> <span>\" + arr[i][1] +\" / \" + lines.length + \" requests</span></div></div></div><div class='percent-bar' style='width:\" + barWidth + \"'></div></li>\")\n    $('#js-log-files').append(\"<li><div class='hostnames-list__data'><div class='hostnames-list__host'><img class='file-icon' src='file.svg' alt='file icon'>\" + \"  \" + arr2[i][0] +\"</div><div class='hostnames-list__numbers'><div class='hostnames-list__percent'>\" + percent2  + \"%</div><div><span>\" + arr2[i][1] +\" / \" + lines.length + \" requests</span></div></div></div><div class='percent-bar' style='width:\" + barWidth + \"'></div></li>\")\n  }\n\n// sorting buttons\n\n\t\t$('.button-sort').click(function() {\n\t\t\tvar x = $('.x');\n\t\t\tvar button = $('.button-sort').index(this)\n\t\t\tvar list = x.eq(button);\n\t\t\tvar listItems = list.children('li');\n\t\t\tlist.append(listItems.get().reverse());\n      $(this).toggleClass('arrow-animate')\n\t\t});\n\n\n\n\tvar previousScroll = 0;\n\n\t$(window).scroll(function(){\n\t\tvar currentScroll = $(this).scrollTop();\n\t\tif (currentScroll > 0 && currentScroll < $(document).height() - $(window).height()){\n\t\t\tif (currentScroll > previousScroll){\n\t\t\t\twindow.setTimeout(hideNav, 300);\n\t\t\t} else {\n\t\t\t\twindow.setTimeout(showNav, 300);\n\t\t\t}\n\t\t\tpreviousScroll = currentScroll;\n\t\t}\n\t});\n\n\tfunction hideNav() {\n\t\t$(\"header\").removeClass(\"is-down\").addClass(\"is-up\");\n\t}\n\tfunction showNav() {\n\t\t$(\"header\").removeClass(\"is-up\").addClass(\"is-down\");\n\t}\n});\n"]}